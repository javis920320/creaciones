https://www.youtube.com/watch?v=tnA2yc47gxg---- destroy table



/select idproceso,pd.factura,tp.nomtipoprod,pr.nomprod,p1.cantidad,sysdate(),p1.precio
 from proceso p1
inner join producto pr on pr.id_prod=p1.id_prod 
inner join tipo_producto tp on tp.idtipoprod=pr.idtipoprod
inner join pedido pd on pd.idpedido=p1.idpedido
inner join trabajador tr on tr.idtrabajador=p1.idtrabajador
inner join persona pe on pe.idpersona =tr.idpersona
where  pe.idpersona=1;



/*insert into proceso values(null,'10','1',sysdate(),70,59,1,(select(p. subvalor*10) from precio p 
inner join producto pr on pr.id_prod=p.id_prod where pr.id_prod=70 limit 1) );





DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `PA_INGRESARPROCES`(IN `cantidad` INT, IN `idtrabajador` INT, IN `idprod` INT, IN `idpedido` INT)
    NO SQL
    COMMENT 'procedimiento para ingresar un proceso de operario'
insert into proceso values(null,cantidad,'1',sysdate(),idprod,idpedido,idtrabajador,(select(p. subvalor*cantidad) from precio p 
inner join producto pr on pr.id_prod=p.id_prod where pr.id_prod=idprod and p.estado=1 limit 1) )$$
DELIMITER ;


--->para  calcular los productos  disponibles  en procesos
DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `PA_CALCULARDISPONIBLES`(IN `idpedido` INT)
    NO SQL
    COMMENT 'para  calcular los productos  disponibles  en procesos'
select (select p.cantidad  from pedido p where p.idpedido=idpedido )-sum(pr.cantidad)  from proceso pr where pr.idpedido=idpedido$$
DELIMITER ;


---- modificar este  campon en proceso almacenado
insert into proceso values(null,cantidad,'1',sysdate(),idprod,idpedido,idtrabajador,(select(p. subvalor*cantidad) from precio p 
inner join producto pr on pr.id_prod=p.id_prod where pr.id_prod=idprod and p.estado=1 limit 1),(select(p.valor*cantidad) from precio p 
inner join producto pr on pr.id_prod=p.id_prod where pr.id_prod=idprod and p.estado=1 limit 1) )


--->agregar campo precio1 en tabla proceso


select pr.idproceso,pd.factura,p.nomprod,pd.descripcion,pr.cantidad,pr.precio,pr.precio1 from proceso pr 
inner join producto p on p.id_prod=pr.id_prod
inner join pedido pd  on pd.idpedido=pr.idpedido ;


---- de extrema importancia

https://www.youtube.com/watch?v=n_wGjsaqdt4 generara bakup automatico



@echo off
set mydate=%date:~6,4%%date:~3,2%%date:~0,2%

c:\xampp\mysql\bin\mysqldump.exe -u root -p --password=123 basedatos > c:\xampp\htdocs\sistema\MYSQLBackUP\%mydate%.sql



https://www.youtube.com/watch?v=ZfgwK1ztrDI



--- codigo  generar listado total proceso

 select pr. idproceso,p.factura,po.nomprod,p.descripcion,pr.cantidad,v.valor,v.subvalor,pr.fecha,pe.nombres
 from proceso pr
 inner join pedido p on p.idpedido = pr.idpedido
 inner join producto po on po.id_prod=pr.id_prod 
 inner join precio v on v.id_prod = pr.id_prod
 inner join trabajador t on t.idtrabajador = pr.idtrabajador
 inner join persona pe on pe.idpersona=t.idpersona 
 order by pe.nombres


 --- decode 

  select pe.cedula,pe.nombres,pe.telefono,
 case u.tipo
 when 1 then 'ADMINISTRADOR'
  when 2 then 'ADMINISTRADOR'
   when 3 then 'ADMINISTRADOR'
 END ,u.estado from persona pe
 inner join usuarios u on pe.idpersona = u.idpersona 



 ---


 DROP TABLE IF EXISTS `bordados` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bordados` (
  `idbordado` INT NOT NULL COMMENT '',
  `nombrebordado` VARCHAR(100) NULL COMMENT '',
  `precio` INT NULL COMMENT '',
  `id_prod` INT NOT NULL COMMENT '',
  PRIMARY KEY (`idbordado`)  COMMENT '')
ENGINE = InnoDB;

SHOW WARNINGS;




//// nuevas tablas



select p.id_prod,tp.nomtipoprod,p.nomprod,pr.valor,pr.valor,sum(b.cantidad) from producto p
  inner join tipo_producto tp on p.idtipoprod = tp.idtipoprod
  inner join precio pr on p.id_prod = pr.id_prod
  inner join bordados b on b.id_prod = p.id_prod group by p.id_prod
  
  
  
  
  CREATE TABLE IF NOT EXISTS `creaciones`.`bordadosproductos` (
  `idbordados` INT NOT NULL,
  `id_prod` INT NOT NULL,
  `cantidad` INT NULL,
  PRIMARY KEY (`idbordados`, `id_prod`),
  INDEX `fk_bordados_has_PRODUCTO_PRODUCTO1_idx` (`id_prod` ASC),
  INDEX `fk_bordados_has_PRODUCTO_bordados1_idx` (`idbordados` ASC),
  CONSTRAINT `fk_bordados_has_PRODUCTO_bordados1`
    FOREIGN KEY (`idbordados`)
    REFERENCES `creaciones`.`bordados` (`idbordados`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_bordados_has_PRODUCTO_PRODUCTO1`
    FOREIGN KEY (`id_prod`)
    REFERENCES `creaciones`.`PRODUCTO` (`id_prod`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB


CREATE TABLE IF NOT EXISTS `creaciones`.`bordados` (
  `idbordados` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NULL,
  `precio` INT NULL,
  PRIMARY KEY (`idbordados`))
ENGINE = InnoDB
 

 //sql para generar  resumen mensual

 select pr.idproceso,pd.factura,p.nomprod,pd.descripcion,pr.cantidad,pr.precio,pr.precio1,(sum(bp.cantidad)*pr.cantidad) as nbordados,(sum(b.precio)*pr.cantidad)"valor bordado",pr.fecha,pe.nombres
from proceso pr
inner join producto p on p.id_prod=pr.id_prod
inner join  bordadosproductos bp on p.id_prod = bp.id_prod
inner join bordados b on b.idbordados = bp.idbordados
inner join pedido pd on pd.idpedido=pr.idpedido
inner join trabajador t on t.idtrabajador=pr.idtrabajador
inner join persona pe on pe.idpersona=t.idpersona
 where pr.fecha>='2017-10-11' and pr.fecha<='2017-11-11'
<<<<<<< HEAD
group by pr.idproceso,bp.id_prod


 AUMENTAR PREBORDADO EN PROCESOS
=======






#select * from producto
#select * from precio where id_prod = 28
#select * from bordados
#select * from bordadosproductos where id_prod = 28
/* select sum(p.precio1) 
 from proceso p 
 inner join producto pd on pd.id_prod = p.id_prod
 inner join  bordadosproductos bp on p.id_prod = bp.id_prod
 where p.fecha>='2017-10-11' and p.fecha<='2017-11-14'
 and p.id_prod=28
 group by p.idproceso
*/

/*select producto.nomprod,b.nombre as "tipo bordado",b.precio as "valor bordado c/u",bp.cantidad,bp.cantidad*b.precio as total 
from bordadosproductos bp
inner join producto ON bp.id_prod = producto.id_prod
inner join bordados b on b.idbordados = bp.idbordados*/


select sum(bp.cantidad*b.precio) as total 
from bordadosproductos bp
inner join producto ON bp.id_prod = producto.id_prod
inner join bordados b on b.idbordados = bp.idbordados


/*select * from proceso*/


/*select * from proceso p 
 inner join producto pd on pd.id_prod = p.id_prod
 inner join  bordadosproductos bp on p.id_prod = bp.id_prod
 where p.fecha>='2017-10-11' and p.fecha<='2017-11-14'
group by p.idproceso*/
group by pr.idproceso,bp.id_prod
>>>>>>> 1e18f34e7664ea19a80c254353adba7479204175




http://www.codedrinks.com/crear-un-reporte-en-excel-con-php-y-mysql/


http://www.ahowto.net/php/easily-integrateload-phpexcel-into-codeigniter-framework/


http://www.anerbarrena.com/jquery-post-5064/

---VISTA CONSULTASALDO
select `pe`.`nombres` AS `nombres`,sum(`pro`.`cantidad`) AS `sum(pro.cantidad)`,sum(`pro`.`precio`) AS `sum(pro.precio)` from `creacion_goretti`.`periodo` `pr` join ((`creacion_goretti`.`proceso` `pro` join `creacion_goretti`.`trabajador` `t` on((`t`.`idtrabajador` = `pro`.`idtrabajador`))) join `creacion_goretti`.`persona` `pe` on((`pe`.`idpersona` = `t`.`idpersona`))) where (`pro`.`fecha` between `pr`.`fechai` and `pr`.`fechaf`) group by `t`.`idtrabajador`


--generacion pdf dompdf

https://huguidugui.wordpress.com/2017/04/25/generar-pdf-con-dompdf-en-codeigniter/



https://github.com/javis920320/TecnoSmartTools



*** proceso  para  lista  cliente - trabajador

select p.idproceso, pe. idpedido,pe.idpedido, pe.factura,per.nombres,(select px.nombres from trabajador t   inner join persona px on px.idpersona = t.idpersona  where t.idtrabajador=tr.idtrabajador )persona
from proceso p
inner join pedido pe on pe.idpedido = p.idpedido
inner join cliente c on c.idcliente = pe.idcliente
inner join persona per on per.idpersona = c.idpersona
inner join trabajador tr on tr.idtrabajador=p.idtrabajador
inner join tipo_producto tp on tp.idtipoprod = pe.idtipoprod
inner join producto pro on pro.id_prod = p.id_prod




/**VISTA PARA VER SALDOS ANTERIORES**//


select pe.nombres as nombres,sum(pr.cantidad)as cantidad,sum(pr.precio)as saldo,x.fechai as fechai,x.fechaf as fechaf
  from periodo x,proceso pr
  inner join trabajador tr on tr.idtrabajador = pr.idtrabajador
  inner join persona pe on pe.idpersona = tr.idpersona
  where x. estado=1 and  pr.fecha between x.fechai and x.fechaf group by tr.idtrabajador